C/ From PDF p. 269 of "Programming in HAL/S".

D INCLUDE TEMPLATE CPL269

  STALL:
  PROCEDURE ASSIGN(PCB);
     DECLARE PCB PROCESS_CONTROL-STRUCTURE;
     DECLARE FREEPC NAME PROCESS_CONTROL-STRUCTURE;
     
C  REMOVE FROM READY QUEUE

C                          .
C                          .
C                          .

     NAME(PCB.LAST.NEXT) = NAME(PCB.NEXT);
     NAME(PCB.NEXT.LAST) = NAME(PCB.LAST);

C  ADD TO STALLED QUEUE AT THE BEGINNING

     NAME(PCB.NEXT) = NAME(FREEPC);
     NAME(FREEPC) = NAME(PCB);
  CLOSE STALL;
